(()=>{var _=(v,I,e)=>new Promise((g,x)=>{var C=p=>{try{c(e.next(p))}catch(b){x(b)}},k=p=>{try{c(e.throw(p))}catch(b){x(b)}},c=p=>p.done?g(p.value):Promise.resolve(p.value).then(C,k);c((e=e.apply(v,I)).next())});window.chattermateId;window.ChatterMate;(function(){function v(t){return/^#[0-9A-F]{6}$/i.test(t)}function I(){return"https://api.chattermate.chat/api/v1"}let e={baseUrl:I(),containerId:"chattermate-container",buttonId:"chattermate-button",chatBubbleColor:"#f34611",loadingContainerId:"chattermate-loading",tokenKey:"ctid",containerBottom:100,containerRight:20,containerWidth:400,chatInitiationMessages:[],initiationMessageId:"chattermate-initiation",initiationShownKey:"ctim_shown"};function g(){let t=document.createElement("style");t.id="chattermate-styles",t.textContent=`
      #${e.buttonId} {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 60px;
        height: 60px;
        border-radius: 30px;
        background: ${e.chatBubbleColor};
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.15);
        cursor: pointer;
        z-index: 999999;
        transition: transform 0.3s ease;
      }

      #${e.buttonId}:hover {
        transform: scale(1.1);
      }

      #${e.buttonId}.loading {
        position: relative;
      }

      #${e.buttonId}.loading:after {
        content: '';
        position: absolute;
        width: 16px;
        height: 16px;
        top: 50%;
        left: 50%;
        margin: -8px 0 0 -8px;
        border: 2px solid rgba(255,255,255,0.3);
        border-radius: 50%;
        border-top-color: #fff;
        animation: chattermate-spin 0.6s linear infinite;
      }

      #${e.buttonId}.active .chat-icon {
        display: none;
      }

      #${e.buttonId}.active .close-icon {
        display: block !important;
      }

      @keyframes chattermate-spin {
        to {transform: rotate(360deg);}
      }

      /* Subtle idle bounce for the chat button when closed */
      @keyframes chattermate-bounce {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-3px); }
      }

      #${e.containerId} {
        position: fixed;
        bottom: ${e.containerBottom||100}px;
        right: ${e.containerRight||20}px;
        width: ${e.containerWidth||400}px;
        height: 600px;
        background: transparent;
        z-index: 999999;
        overflow: hidden;
        /* Animated open/close with slide + fade */
        opacity: 0;
        visibility: hidden;
        transform: translateY(16px) scale(0.98);
        transition: opacity 360ms cubic-bezier(0.22, 1, 0.36, 1), transform 360ms cubic-bezier(0.22, 1, 0.36, 1), visibility 0s linear 360ms;
        border: none;
        padding: 0;
        margin: 0;
        pointer-events: none;
      }

      #${e.containerId}.active {
        opacity: 1;
        visibility: visible;
        transform: translateY(0) scale(1);
        transition: opacity 420ms cubic-bezier(0.22, 1, 0.36, 1), transform 420ms cubic-bezier(0.22, 1, 0.36, 1);
        pointer-events: auto;
      }

      /* Clean border around the widget container */
      #${e.containerId}::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        border-radius: 24px;
        pointer-events: none;
        border: 1px solid #e5e7eb;
      }

        .chattermate-iframe {
                width: 100%;
        height: 100%;
        border: none;
        padding: 0;
        margin: 0;
        display: block;
        border-radius: 24px;
        /* Rely on corner shadows from container */
        box-shadow: none;
      }

      #chattermate-mobile-close {
        display: none;
        position: fixed;
        top: 20px;
        right: 20px;
        width: 44px;
        height: 44px;
        background: transparent;
        border: none;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        z-index: 1000000;
        transition: all 0.3s ease;
      }

      #chattermate-mobile-topbar {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: 60px;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        z-index: 999999;
        align-items: center;
        justify-content: space-between;
        padding: 0 20px;
        box-sizing: border-box;
      }

      #chattermate-mobile-topbar.active {
        display: flex;
      }

      #chattermate-mobile-topbar .topbar-title {
        font-size: 16px;
        font-weight: 600;
        color: #333;
        margin: 0;
      }

      #chattermate-mobile-close.active {
        display: flex;
      }

      @media (max-width: 768px) {
        #${e.containerId} {
          width: 100vw !important;
          height: 100vh !important;
          height: 100dvh !important; /* Dynamic viewport height for mobile browsers */
          top: 0 !important;
          left: 0 !important;
          bottom: 0 !important;
          right: 0 !important;
          border-radius: 0 !important;
          position: fixed !important;
          margin: 0 !important;
          padding: 0 !important;
        }

        #${e.containerId}.active {
          bottom: 0 !important;
        }

        .chattermate-iframe {
          border-radius: 0 !important;
          width: 100vw !important;
          height: 100vh !important;
          height: 100dvh !important; /* Dynamic viewport height for mobile browsers */
          position: absolute !important;
          top: 0 !important;
          left: 0 !important;
          margin: 0 !important;
          padding: 0 !important;
        }

        #${e.buttonId} {
          display: none;
        }

        #${e.buttonId}.mobile-closed {
          display: block !important;
        }

        #chattermate-mobile-close.active {
          display: flex !important;
        }

        #chattermate-mobile-close:hover {
          opacity: 0.7;
        }

        /* ASK_ANYTHING style specific mobile topbar */
        .ask-anything-mobile #chattermate-mobile-topbar.active {
          display: flex !important;
        }

        .ask-anything-mobile #chattermate-mobile-close.active {
          top: 15px !important;
          right: 15px !important;
          z-index: 1000001 !important;
        }

        /* When topbar is visible, push iframe down to avoid overlap */
        .ask-anything-mobile .chattermate-iframe {
          top: 60px !important;
          height: calc(100vh - 60px) !important;
          height: calc(100dvh - 60px) !important;
        }
      }

      @media (min-width: 769px) {
        #chattermate-mobile-close {
          display: none !important;
        }
      }

      /* Chat Initiation Message Styles */
      #${e.initiationMessageId} {
        position: fixed !important;
        bottom: 95px !important;
        right: 20px !important;
        max-width: 240px !important;
        background: white !important;
        padding: 12px 36px 12px 14px !important;
        border-radius: 14px !important;
        box-shadow: 0 3px 16px rgba(0, 0, 0, 0.1) !important;
        z-index: 999998 !important;
        cursor: pointer !important;
        opacity: 0;
        visibility: hidden;
        transform: translateY(10px) scale(0.95);
        transition: all 0.4s cubic-bezier(0.22, 1, 0.36, 1) !important;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;
        box-sizing: border-box !important;
        margin: 0 !important;
        border: none !important;
        display: block !important;
        width: auto !important;
        height: auto !important;
        min-width: 0 !important;
        min-height: 0 !important;
        max-height: none !important;
        line-height: normal !important;
        text-align: left !important;
        vertical-align: baseline !important;
        overflow: visible !important;
      }

      #${e.initiationMessageId}.show {
        opacity: 1;
        visibility: visible;
        transform: translateY(0) scale(1);
        animation: chattermate-bounce-in 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      }

      @keyframes chattermate-bounce-in {
        0% {
          opacity: 0;
          transform: translateY(20px) scale(0.8);
        }
        50% {
          transform: translateY(-5px) scale(1.02);
        }
        100% {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }

      #${e.initiationMessageId}:hover {
        transform: translateY(-2px) scale(1.02);
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.14);
      }

      #${e.initiationMessageId}::after {
        content: '' !important;
        position: absolute !important;
        bottom: -7px !important;
        right: 30px !important;
        width: 14px !important;
        height: 14px !important;
        min-width: 14px !important;
        min-height: 14px !important;
        max-width: 14px !important;
        max-height: 14px !important;
        background: white !important;
        transform: rotate(45deg) !important;
        box-shadow: 3px 3px 5px rgba(0, 0, 0, 0.06) !important;
        clip-path: polygon(0 0, 100% 0, 100% 100%) !important;
        border: none !important;
        margin: 0 !important;
        padding: 0 !important;
        box-sizing: border-box !important;
        z-index: -1 !important;
      }

      .initiation-message-text {
        font-size: 13px !important;
        line-height: 1.4 !important;
        color: #374151 !important;
        margin: 0 !important;
        padding: 0 4px 0 0 !important;
        position: relative !important;
        z-index: 1 !important;
        min-height: 18px !important;
        box-sizing: border-box !important;
        border: none !important;
        background: transparent !important;
        display: block !important;
        width: 100% !important;
        height: auto !important;
        max-width: none !important;
        max-height: none !important;
        text-align: left !important;
        vertical-align: baseline !important;
        font-weight: normal !important;
        font-style: normal !important;
        text-decoration: none !important;
        text-transform: none !important;
        letter-spacing: normal !important;
        word-spacing: normal !important;
        white-space: normal !important;
        overflow-wrap: break-word !important;
        word-wrap: break-word !important;
      }

      .initiation-message-text::after {
        content: '|';
        animation: blink 1s step-end infinite;
        margin-left: 2px;
        color: ${e.chatBubbleColor};
        font-weight: 500;
      }

      .initiation-message-text.typing-complete::after {
        display: none;
      }

      @keyframes blink {
        0%, 50% { opacity: 1; }
        51%, 100% { opacity: 0; }
      }

      .initiation-close {
        position: absolute !important;
        top: 10px !important;
        right: 10px !important;
        width: 20px !important;
        height: 20px !important;
        min-width: 20px !important;
        min-height: 20px !important;
        max-width: 20px !important;
        max-height: 20px !important;
        background: rgba(0, 0, 0, 0.04) !important;
        border: none !important;
        border-radius: 5px !important;
        cursor: pointer !important;
        opacity: 0.5 !important;
        transition: all 0.2s ease !important;
        z-index: 2 !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        padding: 0 !important;
        margin: 0 !important;
        box-sizing: border-box !important;
        outline: none !important;
        box-shadow: none !important;
        text-decoration: none !important;
        font-size: 0 !important;
        line-height: 0 !important;
        overflow: hidden !important;
        flex-shrink: 0 !important;
      }

      .initiation-close:hover {
        opacity: 1 !important;
        background: rgba(0, 0, 0, 0.08) !important;
        transform: scale(1.05) !important;
      }

      .initiation-close::before,
      .initiation-close::after {
        content: '' !important;
        position: absolute !important;
        width: 9px !important;
        height: 1.5px !important;
        min-width: 9px !important;
        min-height: 1.5px !important;
        max-width: 9px !important;
        max-height: 1.5px !important;
        background: #4a5568 !important;
        border-radius: 1px !important;
        top: 50% !important;
        left: 50% !important;
        margin: -0.75px 0 0 -4.5px !important;
        padding: 0 !important;
        border: none !important;
        box-sizing: border-box !important;
      }

      .initiation-close::before {
        transform: rotate(45deg) !important;
      }

      .initiation-close::after {
        transform: rotate(-45deg) !important;
      }

      @media (max-width: 768px) {
        #${e.initiationMessageId} {
          display: none !important;
        }
      }

      /* Error UI Styles */
      .chattermate-error-ui {
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        border-radius: 24px;
        overflow: hidden;
        position: relative;
      }

      .chattermate-error-ui::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background:
          radial-gradient(circle at 20% 30%, rgba(99, 102, 241, 0.08) 0%, transparent 50%),
          radial-gradient(circle at 80% 70%, rgba(168, 85, 247, 0.06) 0%, transparent 50%);
        pointer-events: none;
      }

      .chattermate-error-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 32px 24px;
        text-align: center;
        position: relative;
        z-index: 1;
        max-width: 90%;
      }

      .chattermate-error-icon-wrapper {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 72px;
        height: 72px;
        background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%);
        border-radius: 20px;
        margin-bottom: 20px;
        box-shadow: 0 8px 24px rgba(99, 102, 241, 0.15);
      }

      .chattermate-error-icon {
        width: 36px;
        height: 36px;
        color: #6366f1;
      }

      .chattermate-error-title {
        font-size: 20px;
        font-weight: 600;
        color: #1e293b;
        margin: 0 0 12px 0;
        letter-spacing: -0.01em;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      }

      .chattermate-error-message {
        font-size: 14px;
        line-height: 1.6;
        color: #64748b;
        margin: 0 0 24px 0;
        max-width: 280px;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      }

      .chattermate-error-footer {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
        font-size: 12px;
        color: #94a3b8;
        opacity: 0.8;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      }

      @media (max-width: 768px) {
        .chattermate-error-ui {
          border-radius: 0;
        }

        .chattermate-error-card {
          padding: 24px 20px;
        }

        .chattermate-error-icon-wrapper {
          width: 64px;
          height: 64px;
          border-radius: 16px;
        }

        .chattermate-error-icon {
          width: 32px;
          height: 32px;
        }

        .chattermate-error-title {
          font-size: 18px;
        }

        .chattermate-error-message {
          font-size: 13px;
          max-width: 260px;
        }
      }
    `;let i=document.getElementById("chattermate-styles");i&&i.remove(),document.head.appendChild(t)}function x(){return window.chattermateToken||localStorage.getItem(e.tokenKey)}function C(t){t&&localStorage.setItem(e.tokenKey,t)}function k(){localStorage.removeItem(e.tokenKey)}function c(){return window.innerWidth<=768}function p(t){return t?t.replace(/\uFFFD/g,"").replace(/[��]/g,"").replace(/[\x00-\x1F\x7F-\x9F]/g,"").trim():""}function b(){if(!e.chatInitiationMessages||e.chatInitiationMessages.length===0)return null;let t=Math.floor(Math.random()*e.chatInitiationMessages.length),i=e.chatInitiationMessages[t];return i?p(i):null}function U(){return c()||!e.chatInitiationMessages||e.chatInitiationMessages.length===0?!1:!sessionStorage.getItem(e.initiationShownKey)}function M(){sessionStorage.setItem(e.initiationShownKey,"true")}function F(){let t=b();if(!t)return null;let i=document.createElement("div");return i.id=e.initiationMessageId,i.innerHTML=`
      <button class="initiation-close" aria-label="Close"></button>
      <p class="initiation-message-text"></p>
    `,i.dataset.fullMessage=t,i}function Y(t,i,n=50){let a=t.querySelector(".initiation-message-text");if(!a)return;let r=0,s=setInterval(()=>{r<i.length?(a.textContent+=i.charAt(r),r++):(clearInterval(s),a.classList.add("typing-complete"),t.typeInterval=null)},n);t.typeInterval=s}function K(t,i){if(!t||!U())return;document.body.appendChild(t),setTimeout(()=>{t.classList.add("show"),setTimeout(()=>{let a=t.dataset.fullMessage;a&&Y(t,a,40)},300)},1500),t.addEventListener("click",a=>{a.target.classList.contains("initiation-close")||(t.typeInterval&&clearInterval(t.typeInterval),L(t),i(),M())});let n=t.querySelector(".initiation-close");n&&n.addEventListener("click",a=>{a.stopPropagation(),t.typeInterval&&clearInterval(t.typeInterval),L(t),M()})}function L(t){t&&(t.classList.remove("show"),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},400))}function T(){g();let t=document.createElement("div");t.id=e.buttonId,t.innerHTML=`
      <svg class="chat-icon" width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M45 15H15C13.3431 15 12 16.3431 12 18V42C12 43.6569 13.3431 45 15 45H25L30 52L35 45H45C46.6569 45 48 43.6569 48 42V18C48 16.3431 46.6569 15 45 15Z" fill="white"/>
        <path d="M36 27C36 27 32.5 26 30 26C27.5 26 24 27 24 31C24 35 27.5 36 30 36C32.5 36 36 35 36 35V33C36 33 33 34 31.5 34C30 34 27 33 27 31C27 29 30 28 31.5 28C33 28 36 29 36 29V27Z" fill="${e.chatBubbleColor}"/>
      </svg>
      <svg class="close-icon" width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: none;">
        <path d="M20 20L40 40M40 20L20 40" stroke="white" stroke-width="3" stroke-linecap="round"/>
      </svg>
    `;let i=document.createElement("div");i.id=e.containerId;let n=document.createElement("div");n.id="chattermate-mobile-close",n.innerHTML=`
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M5 12H19" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    `;let a=document.createElement("div");a.id="chattermate-mobile-topbar",a.innerHTML=`
      <h3 class="topbar-title">Chat</h3>
      <div style="width: 44px;"></div>
    `,document.body.appendChild(t),document.body.appendChild(i),document.body.appendChild(n),document.body.appendChild(a);let r=!1,s=null,E=!1,u=null;function S(){r=!r,i.classList.toggle("active"),t.classList.toggle("active"),n.classList.toggle("active"),r&&u&&(L(u),u=null,M()),c()?r?(t.classList.remove("mobile-closed"),t.style.animation=""):(t.classList.add("mobile-closed"),t.style.animation="chattermate-bounce 2.2s ease-in-out infinite",a.classList.remove("active"),document.body.classList.remove("ask-anything-mobile")):r&&n.classList.remove("active"),r&&s&&s.contentWindow.postMessage({type:"SCROLL_TO_BOTTOM"},"*")}function $(m){let f=document.createElement("div");f.className="chattermate-error-ui";let d=document.createElement("div");d.className="chattermate-error-card";let o=document.createElement("div");o.className="chattermate-error-icon-wrapper";let l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.setAttribute("class","chattermate-error-icon"),l.setAttribute("viewBox","0 0 24 24"),l.setAttribute("fill","none"),l.setAttribute("stroke","currentColor"),l.setAttribute("stroke-width","1.5");let N=document.createElementNS("http://www.w3.org/2000/svg","path");N.setAttribute("d","M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z");let B=document.createElementNS("http://www.w3.org/2000/svg","path");B.setAttribute("d","M9 12l2 2 4-4"),l.appendChild(N),l.appendChild(B),o.appendChild(l);let z=document.createElement("h2");z.className="chattermate-error-title",z.textContent="Chat Unavailable";let A=document.createElement("p");A.className="chattermate-error-message",A.textContent=m;let w=document.createElement("div");w.className="chattermate-error-footer";let h=document.createElementNS("http://www.w3.org/2000/svg","svg");h.setAttribute("width","14"),h.setAttribute("height","14"),h.setAttribute("viewBox","0 0 60 60"),h.setAttribute("fill","none");let y=document.createElementNS("http://www.w3.org/2000/svg","path");y.setAttribute("d","M45 15H15C13.3431 15 12 16.3431 12 18V42C12 43.6569 13.3431 45 15 45H25L30 52L35 45H45C46.6569 45 48 43.6569 48 42V18C48 16.3431 46.6569 15 45 15Z"),y.setAttribute("fill","currentColor"),y.setAttribute("opacity","0.6"),h.appendChild(y);let H=document.createElement("span");return H.textContent="Powered by ChatterMate",w.appendChild(h),w.appendChild(H),d.appendChild(o),d.appendChild(z),d.appendChild(A),d.appendChild(w),f.appendChild(d),f}function R(){return _(this,null,function*(){if(!(E||s))try{E=!0,t.classList.add("loading");let m=x(),f=`${e.baseUrl}/widgets/${window.chattermateId}/data?widget_id=${window.chattermateId}`,d={method:"GET",mode:"cors",headers:m?{Authorization:`Bearer ${m}`}:{}};fetch(f,d).then(o=>{if(o.status===401){t.classList.remove("loading"),k();let l=$("This chat widget is not currently configured. Please contact the website administrator to enable chat support.");return i.appendChild(l),null}if(!o.ok)throw new Error("HTTP error! status: "+o.status);return o.text()}).then(o=>{o!==null&&(s=document.createElement("iframe"),s.className="chattermate-iframe",s.srcdoc=o,i.appendChild(s),t.classList.remove("loading"),s.style.opacity="1")}).catch(o=>{console.error("Failed to load widget:",o),t.classList.remove("loading");let l=$("Unable to load chat. Please try again later.");i.appendChild(l)}),window.addEventListener("message",function(o){o.data.type==="TOKEN_UPDATE"&&s&&(C(o.data.token),s.contentWindow.postMessage({type:"TOKEN_RECEIVED",token:o.data.token},"*"))})}catch(m){console.error("Failed to load widget:",m),t.classList.remove("loading")}finally{E=!1}})}R(),setTimeout(()=>{!r&&e.chatInitiationMessages.length>0&&(u=F(),K(u,S))},2e3),t.addEventListener("click",S),n.addEventListener("click",S),c()&&!r&&(t.classList.add("mobile-closed"),t.style.animation="chattermate-bounce 2.2s ease-in-out infinite"),window.addEventListener("resize",function(){let m=c();m&&!r?(t.classList.add("mobile-closed"),t.style.animation="chattermate-bounce 2.2s ease-in-out infinite",n.classList.remove("active")):m||(t.classList.remove("mobile-closed"),t.style.animation="",r&&n.classList.remove("active")),g()})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",T):T(),window.addEventListener("message",function(t){if(t.data.type==="CUSTOMIZATION_UPDATE"){let i=t.data.data,n=i.chat_bubble_color;e.chatBubbleColor=v(n)?n:e.chatBubbleColor,i.chat_initiation_messages&&Array.isArray(i.chat_initiation_messages)&&(e.chatInitiationMessages=i.chat_initiation_messages),c()?i.chat_style==="ASK_ANYTHING"&&isOpen?(document.body.classList.add("ask-anything-mobile"),mobileTopbar.classList.add("active")):(document.body.classList.remove("ask-anything-mobile"),mobileTopbar.classList.remove("active")):i.chat_style==="ASK_ANYTHING"?(e.containerBottom=90,e.containerRight=20,e.containerWidth=400):(e.containerBottom=100,e.containerRight=20,e.containerWidth=400),g();let a=document.querySelector(`#${e.buttonId} .chat-icon path:last-child`);a&&a.setAttribute("fill",e.chatBubbleColor)}}),window.ChatterMate={init:function(t){t.baseUrl&&(e.baseUrl=t.baseUrl),window.chattermateId=t.id}}})();})();
